<%- include('./PARTIALS/header.ejs') %>

    <h1 class="front-page-title">DONGEONS & DRAGONS HELPER</h1>

    <h2>CHOISIR UN MODE DE JEU</h2>
    <div class="choice">
        <div class="btn-choices">
          <select name="game_mode" id="game_mode">
            <option value="" disabled selected> Choisissez un mode</option>

            <% for (const mode of modes) { %>
            <option value="<%= mode.mode %>"> 
              <%= mode.mode %> 
            </option>
            <% } %>
            </select>
        </div>
        <div id="modeText"></div>
        
    </div>
    
    <script>
        const modes = <%- JSON.stringify(modes) %>;
        const modeText = document.getElementById("modeText");
        const select = document.getElementById("game_mode");
      select.addEventListener("change", () => {
        const selectedValue = select.value;
        const selectedMode = modes.find( m => m.mode === selectedValue);

        if(selectedMode){
          modeText.textContent = selectedMode.content;
        }
      })
      </script>
  

    <button id="rollBtn" type="button">Lancez les dés</button>
    <p>Résultat : <strong id="rollResult"></strong></p>
    

    

<script>
  const btn = document.getElementById('rollBtn');
  const out = document.getElementById('rollResult');

  btn.addEventListener('click', async () => {
    
      const r = await fetch('/roll');
    
      const data = await r.json();
      out.textContent = data.result;
  });
</script>

<%- include('./PARTIALS/footer.ejs') %>